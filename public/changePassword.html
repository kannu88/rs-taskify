<!DOCTYPE html>
<html lang="en">
<head>
  <title>Bootstrap Example</title>
  <meta charset="utf-8">
  <script src = "https://ajax.googleapis.com/ajax/libs/angularjs/1.3.14/angular.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.28//angular-route.min.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
</head>
<body>

<div class="container" ng-app="mainApp" ng-controller="changePasswordController">
  <h2>Change Password</h2>
  <form class="form-horizontal" name="changeForm" ng-submit="changePassword()">
        <div class="form-group">
                <label class="control-label col-sm-2" for="email">Email:</label>
                <div class="col-sm-10">
                  <input type="email" class="form-control" ng-model="userData.email"  placeholder="Enter Email" name="email" required pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$">
                  <span style="color:red;" ng-show="changeForm.email.$dirty && changeForm.email.$invalid"></span>
                  <span style="color:red;" ng-show="changeForm.email.$touched && changeForm.email.$error.required">Email Required</span>
                  <span style="color:red;" ng-show="changeForm.email.$error.pattern">Invalid Email Address</span>
              </div>
              </div>
    <div class="form-group">
      <label class="control-label col-sm-2" for="email">Old Password:</label>
      <div class="col-sm-10">
        <input type="password" required class="form-control" ng-model="userData.oldPassword"  placeholder="Enter old Password" name="oldPassword">
        <span style="color:red;" ng-show="changeForm.oldPassword.$dirty && changeForm.oldPassword.$invalid"></span>
        <span style="color:red;" ng-show="changeForm.oldPassword.$touched && changeForm.oldPassword.$error.required">Old Password Required</span>
    </div>
    </div>
    <div class="form-group">
      <label class="control-label col-sm-2"  for="pwd">New Password:</label>
      <div class="col-sm-10">          
        <input type="password" required class="form-control" id="pwd" ng-model="userData.newPassword" placeholder="Enter New Password" name="newPassword">
        <span style="color:red;" ng-show="changeForm.oldPassword.$dirty && changeForm.oldPassword.$invalid"></span>
        <span style="color:red;" ng-show="changeForm.oldPassword.$touched && changeForm.oldPassword.$error.required">New Password Required</span>
  
      </div>
    </div>
    
    
    <div class="form-group">        
      <div class="col-sm-offset-2 col-sm-10">
        <button type="submit" class="btn btn-default" ng-disabled="changeForm.oldPassword.$dirty && changeForm.oldPassword.$invalid ||
        changeForm.newPassword.$dirty && changeForm.newPassword.$invalid" >Submit</button>
      </div>
    </div>
  </form>
</div>
<script>
var mainApp = angular.module('mainApp',[]);
mainApp.controller('changePasswordController',function($scope,$http,$location){
    var url = "http://localhost:3000/user/resetpassword";
    $scope.changePassword = function()
    {
        $http.post(url,
        {userData:$scope.userData}).then(function(response){
            console.log(response);
				console.log($scope.userData);
				
				
				if(response.data.success===true)
				{
					window.location.href='index.html';
					
				}
				else{
					$scope.msg="Invalid details";
					window.alert("wrong Password");
				}
        })
    }
})
</script>
</body>
</html>
